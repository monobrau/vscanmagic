<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Report Generator Template - River Run MSP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #4F46E5;
            font-size: 20px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #E5E7EB;
        }

        .prompt-box {
            background: #F9FAFB;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            padding: 20px;
            position: relative;
            margin-bottom: 20px;
        }

        .prompt-text {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: #1F2937;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }

        .copy-btn {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .copy-btn:hover {
            background: #4338CA;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .copy-btn.copied {
            background: #10B981;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-card {
            background: #F3F4F6;
            border-left: 4px solid #4F46E5;
            padding: 20px;
            border-radius: 6px;
        }

        .info-card h3 {
            color: #1F2937;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .info-card p, .info-card ul {
            color: #6B7280;
            font-size: 14px;
            line-height: 1.6;
        }

        .info-card ul {
            margin-left: 20px;
        }

        .info-card li {
            margin-bottom: 5px;
        }

        .color-legend {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .color-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
        }

        .color-item.critical {
            background: #DC143C;
            color: white;
        }

        .color-item.high {
            background: #FF8C00;
            color: white;
        }

        .color-item.medium {
            background: #FFFF00;
            color: black;
        }

        .formula-box {
            background: #EEF2FF;
            border: 1px solid #C7D2FE;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
        }

        .formula-box code {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #4338CA;
            display: block;
            margin-bottom: 10px;
        }

        .formula-box p {
            font-size: 13px;
            color: #4B5563;
            line-height: 1.5;
        }

        .footer {
            background: #F9FAFB;
            padding: 20px 30px;
            text-align: center;
            color: #6B7280;
            font-size: 13px;
            border-top: 1px solid #E5E7EB;
        }

        .badge {
            display: inline-block;
            background: #10B981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Vulnerability Assessment Report Generator</h1>
            <p>River Run MSP - Security Engineering Template</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>Quick Start Prompt <span class="badge">Copy & Use</span></h2>
                <div class="prompt-box">
                    <div class="prompt-text" id="promptText">Create a vulnerability assessment report from the provided XLSX vulnerability scan file.

ANALYSIS REQUIREMENTS:
- Calculate Composite Risk Score = Vulnerability Count √ó EPSS Score √ó Average CVSS Equivalent
  - CVSS Equivalent: Critical=9.0, High=7.0, Medium=5.0, Low=3.0
- Extract top 10 items by composite risk score
- Consolidate Windows versions by OS family:
  - "Windows Server 2012" + "Windows Server 2012 R2" ‚Üí "Windows Server 2012 (all versions)"
  - "Windows 1122H2" + "Windows 1123H2" + "Windows 1124H2" + "Windows 11" ‚Üí "Windows 11 (all versions)"
  - Keep "Windows Server 2016" separate
  - "Windows 1022H2" + "Windows 10" ‚Üí "Windows 10 (all versions)"

FILTERING:
- Remove auto-updating browsers (Google Chrome, Mozilla Firefox)
- Exclude "OS-OUT-OF-SUPPORT" entries (redundant with individual OS entries)
- Include all other products

TABLE FORMAT:
- Create colored table with rows: Rank, Product/System, Risk Score, EPSS, Avg CVSS, Total Vulns, Affected Systems
- Color thresholds:
  - Red background: Risk Score ‚â• 7,500 (white text)
  - Orange background: Risk Score ‚â• 1,000 (white text)
  - Yellow background: Risk Score > 0 (black text)

REPORT STRUCTURE:
- Title: "Vulnerability Assessment Report" with client name and scan date
- Executive Summary (mention ConnectWise Automate patch management, no WSUS)
- Scoring Methodology section
- Color-coded Top 10 table
- Risk Score Color Legend
- Detailed Findings section with remediation guidance for each item

REMEDIATION GUIDANCE:
- End-of-support operating systems: Note as "infrastructure project beyond quarterly vulnerability scope"
- Windows patch inconsistencies: Reference ConnectWise Automate investigation, note that lower vulnerability counts indicate working patching
- Applications: Note if deployable via ConnectWise Automate/RMM
- Network devices (printers, IoT): Manual firmware updates via manufacturer tools
- Do NOT provide timelines or phased deployment schedules
- Focus on what needs to be done, not when

SPECIAL CONSIDERATIONS:
- Identify Ripple20 devices as "Network Printers" if applicable
- Note Microsoft Teams can be remediated via RMM script
- Avoid WSUS references (not in use)
- For machines with few vulnerabilities: explain may indicate patching is working correctly, awaiting latest cycles
- For inconsistent patch levels: suggest investigating Windows Update status via ConnectWise Automate

OUTPUT:
- Word document (.docx) with professional formatting
- Include affected systems list for each item
- Make report actionable for MSP use with clients</div>
                </div>
                <button class="copy-btn" onclick="copyPrompt()">
                    <span id="copyIcon">üìã</span>
                    <span id="copyText">Copy Prompt to Clipboard</span>
                </button>
            </div>

            <div class="section">
                <h2>Risk Score Calculation</h2>
                <div class="formula-box">
                    <code>Risk Score = Vulnerability Count √ó EPSS Score √ó Average CVSS Equivalent</code>
                    <p><strong>Average CVSS Calculation:</strong><br>
                    (Critical √ó 9.0 + High √ó 7.0 + Medium √ó 5.0 + Low √ó 3.0) / Total Vulnerabilities</p>
                </div>

                <div class="color-legend">
                    <div class="color-item critical">Critical: ‚â• 7,500</div>
                    <div class="color-item high">High: ‚â• 1,000</div>
                    <div class="color-item medium">Medium: > 0</div>
                </div>
            </div>

            <div class="section">
                <h2>Key Information</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <h3>Required Excel Sheet</h3>
                        <p>Your file must contain a sheet named <strong>"Source Data"</strong> with vulnerability information.</p>
                    </div>

                    <div class="info-card">
                        <h3>Required Columns</h3>
                        <ul>
                            <li>Host Name, IP, Product</li>
                            <li>Critical, High, Medium, Low</li>
                            <li>Vulnerability Count</li>
                            <li>EPSS Score</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>Automatic Filtering</h3>
                        <ul>
                            <li>Auto-updating browsers</li>
                            <li>OS-OUT-OF-SUPPORT entries</li>
                            <li>Windows version consolidation</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3>Output Format</h3>
                        <p>Professional Word document (.docx) with executive summary, color-coded tables, and detailed remediation guidance.</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Windows Consolidation Rules</h2>
                <div class="info-card">
                    <h3>Automatic Grouping</h3>
                    <ul>
                        <li><strong>Windows Server 2012 (all versions)</strong> ‚Üê Server 2012 + Server 2012 R2</li>
                        <li><strong>Windows 11 (all versions)</strong> ‚Üê 11 22H2 + 23H2 + 24H2 + 11</li>
                        <li><strong>Windows 10 (all versions)</strong> ‚Üê 10 22H2 + 10</li>
                        <li><strong>Windows Server 2016</strong> ‚Üê Kept separate</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>Usage Instructions</h2>
                <div class="info-card">
                    <h3>Step-by-Step Process</h3>
                    <ol style="margin-left: 20px; color: #6B7280; font-size: 14px; line-height: 1.8;">
                        <li>Upload your vulnerability scan XLSX file to Claude</li>
                        <li>Copy the prompt above (click the Copy button)</li>
                        <li>Paste the prompt into Claude's chat</li>
                        <li>Claude will process the data and generate your report</li>
                        <li>Download the Word document from the outputs folder</li>
                        <li>Review and customize as needed for your client</li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><strong>River Run MSP</strong> | Security Engineering Tools</p>
            <p style="margin-top: 8px;">Template Version 1.0 | Last Updated: November 2025</p>
            <p style="margin-top: 8px; font-size: 12px;">Bookmark this page for quick access to the vulnerability report generator</p>
        </div>
    </div>

    <script>
        function copyPrompt() {
            const promptText = document.getElementById('promptText').textContent;
            const copyBtn = document.querySelector('.copy-btn');
            const copyIcon = document.getElementById('copyIcon');
            const copyText = document.getElementById('copyText');

            navigator.clipboard.writeText(promptText).then(() => {
                copyBtn.classList.add('copied');
                copyIcon.textContent = '‚úì';
                copyText.textContent = 'Copied to Clipboard!';

                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    copyIcon.textContent = 'üìã';
                    copyText.textContent = 'Copy Prompt to Clipboard';
                }, 3000);
            }).catch(err => {
                alert('Failed to copy. Please select and copy manually.');
            });
        }
    </script>
</body>
</html>
